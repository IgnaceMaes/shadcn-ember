{
  "$schema": "https://shadcn-ember.com/schema/registry-item.json",
  "name": "select",
  "type": "registry:ui",
  "files": [
    {
      "path": "registry/new-york-v4/ui/select.gts",
      "content": "import { on } from '@ember/modifier';\nimport { htmlSafe } from '@ember/template';\nimport {\n  computePosition,\n  flip,\n  shift,\n  offset,\n  autoUpdate,\n  type Placement,\n} from '@floating-ui/dom';\nimport Component from '@glimmer/component';\nimport { tracked } from '@glimmer/tracking';\nimport { cached } from '@glimmer/tracking';\nimport onClickOutside from 'ember-click-outside/modifiers/on-click-outside';\nimport { modifier } from 'ember-modifier';\nimport { provide, consume } from 'ember-provide-consume-context';\n\nimport { cn } from '@/lib/utils';\n\nimport type { TOC } from '@ember/component/template-only';\nimport type Owner from '@ember/owner';\n\nimport Check from '~icons/lucide/check';\nimport ChevronDown from '~icons/lucide/chevron-down';\nimport ChevronUp from '~icons/lucide/chevron-up';\n\nconst SelectContext = 'select-context' as const;\n\ninterface SelectContextValue {\n  value: string;\n  selectedLabel: string;\n  isOpen: boolean;\n  isRendered: boolean;\n  disabled: boolean;\n  toggle: () => void;\n  close: () => void;\n  finishClose: () => void;\n  selectValue: (value: string, label: string) => void;\n  triggerElement: HTMLElement | null;\n  setTriggerElement: (element: HTMLElement | null) => void;\n}\n\ninterface ContextRegistry {\n  [SelectContext]: SelectContextValue;\n}\n\ninterface SelectSignature {\n  Args: {\n    value?: string;\n    defaultValue?: string;\n    onValueChange?: (value: string) => void;\n    disabled?: boolean;\n    name?: string;\n    required?: boolean;\n  };\n  Blocks: {\n    default: [];\n  };\n}\n\nclass Select extends Component<SelectSignature> {\n  @tracked isOpen = false;\n  @tracked isRendered = false;\n  @tracked selectedValue: string;\n  @tracked selectedLabel = '';\n  triggerElement: HTMLElement | null = null;\n\n  constructor(owner: Owner, args: SelectSignature['Args']) {\n    super(owner, args);\n    this.selectedValue = args.value ?? args.defaultValue ?? '';\n  }\n\n  get value() {\n    return this.args.value ?? this.selectedValue;\n  }\n\n  toggle = () => {\n    if (!this.args.disabled) {\n      if (this.isOpen) {\n        this.close();\n      } else {\n        this.isRendered = true;\n        this.isOpen = true;\n      }\n    }\n  };\n\n  close = () => {\n    this.isOpen = false;\n  };\n\n  finishClose = () => {\n    if (!this.isOpen) {\n      this.isRendered = false;\n    }\n  };\n\n  selectValue = (value: string, label: string) => {\n    this.selectedValue = value;\n    this.selectedLabel = label;\n    this.close();\n    this.args.onValueChange?.(value);\n  };\n\n  setTriggerElement = (element: HTMLElement | null) => {\n    this.triggerElement = element;\n  };\n\n  @cached\n  @provide(SelectContext)\n  get context(): SelectContextValue {\n    return {\n      value: this.value,\n      selectedLabel: this.selectedLabel,\n      isOpen: this.isOpen,\n      isRendered: this.isRendered,\n      disabled: this.args.disabled ?? false,\n      toggle: this.toggle,\n      close: this.close,\n      finishClose: this.finishClose,\n      selectValue: this.selectValue,\n      triggerElement: this.triggerElement,\n      setTriggerElement: this.setTriggerElement,\n    };\n  }\n\n  <template>\n    {{! template-lint-disable no-yield-only }}\n    {{yield}}\n  </template>\n}\n\ninterface SelectTriggerSignature {\n  Element: HTMLButtonElement;\n  Args: {\n    class?: string;\n    size?: 'sm' | 'default';\n  };\n  Blocks: {\n    default: [];\n  };\n}\n\nclass SelectTrigger extends Component<SelectTriggerSignature> {\n  @consume(SelectContext) context!: ContextRegistry[typeof SelectContext];\n\n  get sizeClass() {\n    return this.args.size === 'sm' ? 'h-8' : 'h-9';\n  }\n\n  registerElement = modifier((element: HTMLElement) => {\n    this.context.setTriggerElement(element);\n    return () => {\n      this.context.setTriggerElement(null);\n    };\n  });\n\n  <template>\n    <button\n      class={{cn\n        \"border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50\"\n        this.sizeClass\n        \"*:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\"\n        @class\n      }}\n      data-placeholder={{if this.context.value null \"\"}}\n      data-size={{if @size @size \"default\"}}\n      data-slot=\"select-trigger\"\n      disabled={{this.context.disabled}}\n      type=\"button\"\n      {{on \"click\" this.context.toggle}}\n      {{this.registerElement}}\n      ...attributes\n    >\n      {{yield}}\n      <ChevronDown class=\"size-4 opacity-50\" />\n    </button>\n  </template>\n}\n\ninterface SelectValueSignature {\n  Element: HTMLSpanElement;\n  Args: {\n    class?: string;\n    placeholder?: string;\n  };\n  Blocks: {\n    default: [];\n  };\n}\n\nclass SelectValue extends Component<SelectValueSignature> {\n  @consume(SelectContext) context!: ContextRegistry[typeof SelectContext];\n\n  <template>\n    <span class={{cn @class}} data-slot=\"select-value\" ...attributes>\n      {{#if (has-block)}}\n        {{yield}}\n      {{else if this.context.selectedLabel}}\n        {{this.context.selectedLabel}}\n      {{else if this.context.value}}\n        {{this.context.value}}\n      {{else}}\n        {{@placeholder}}\n      {{/if}}\n    </span>\n  </template>\n}\n\ninterface SelectContentSignature {\n  Element: HTMLDivElement;\n  Args: {\n    class?: string;\n    position?: 'popper' | 'item-aligned';\n    align?: 'start' | 'center' | 'end';\n  };\n  Blocks: {\n    default: [];\n  };\n}\n\nclass SelectContent extends Component<SelectContentSignature> {\n  @consume(SelectContext) context!: ContextRegistry[typeof SelectContext];\n\n  @tracked x = 0;\n  @tracked y = 0;\n  cleanup?: () => void;\n\n  get destinationElement() {\n    return document.body;\n  }\n\n  get positionClass() {\n    return this.args.position === 'popper'\n      ? 'data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1'\n      : '';\n  }\n\n  handleClickOutside = () => {\n    this.context.close();\n  };\n\n  handleAnimationEnd = (event: AnimationEvent) => {\n    if (event.target === event.currentTarget && !this.context.isOpen) {\n      this.context.finishClose();\n    }\n  };\n\n  positionContent = modifier(\n    (\n      element: HTMLElement,\n      [triggerElement]: [HTMLElement | null | undefined]\n    ) => {\n      if (!triggerElement) return;\n\n      const align = this.args.align ?? 'start';\n      const placementMap: Record<string, Placement> = {\n        start: 'bottom-start',\n        center: 'bottom',\n        end: 'bottom-end',\n      };\n\n      const update = () => {\n        void computePosition(triggerElement, element, {\n          placement: placementMap[align] || 'bottom-start',\n          strategy: 'fixed',\n          middleware: [offset(4), flip(), shift({ padding: 8 })],\n        }).then(({ x, y }) => {\n          this.x = x;\n          this.y = y;\n        });\n      };\n\n      this.cleanup = autoUpdate(triggerElement, element, update);\n\n      return () => {\n        this.cleanup?.();\n      };\n    }\n  );\n\n  get positionStyle() {\n    return htmlSafe(\n      `position: fixed; left: ${this.x}px; top: ${this.y}px; z-index: 50;`\n    );\n  }\n\n  <template>\n    {{#if this.context.isRendered}}\n      {{#in-element this.destinationElement insertBefore=null}}\n        <div\n          class={{cn\n            \"bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-96 min-w-32 overflow-x-hidden overflow-y-auto rounded-md border shadow-md\"\n            this.positionClass\n            @class\n          }}\n          data-slot=\"select-content\"\n          data-state={{if this.context.isOpen \"open\" \"closed\"}}\n          role=\"listbox\"\n          style={{this.positionStyle}}\n          {{on \"animationend\" this.handleAnimationEnd}}\n          {{onClickOutside this.handleClickOutside}}\n          {{this.positionContent this.context.triggerElement}}\n          ...attributes\n        >\n          <div class=\"p-1\">\n            {{yield}}\n          </div>\n        </div>\n      {{/in-element}}\n    {{/if}}\n  </template>\n}\n\ninterface SelectGroupSignature {\n  Element: HTMLDivElement;\n  Args: {\n    class?: string;\n  };\n  Blocks: {\n    default: [];\n  };\n}\n\nconst SelectGroup: TOC<SelectGroupSignature> = <template>\n  <div class={{cn @class}} data-slot=\"select-group\" ...attributes>\n    {{yield}}\n  </div>\n</template>;\n\ninterface SelectLabelSignature {\n  Element: HTMLDivElement;\n  Args: {\n    class?: string;\n  };\n  Blocks: {\n    default: [];\n  };\n}\n\nconst SelectLabel: TOC<SelectLabelSignature> = <template>\n  <div\n    class={{cn \"text-muted-foreground px-2 py-1.5 text-xs\" @class}}\n    data-slot=\"select-label\"\n    ...attributes\n  >\n    {{yield}}\n  </div>\n</template>;\n\ninterface SelectItemSignature {\n  Element: HTMLDivElement;\n  Args: {\n    class?: string;\n    value: string;\n    disabled?: boolean;\n  };\n  Blocks: {\n    default: [];\n  };\n}\n\nclass SelectItem extends Component<SelectItemSignature> {\n  @consume(SelectContext) context!: ContextRegistry[typeof SelectContext];\n\n  itemElement: HTMLDivElement | null = null;\n\n  get isSelected() {\n    return this.args.value === this.context.value;\n  }\n\n  handleClick = () => {\n    if (!this.args.disabled) {\n      const label = this.itemElement?.textContent?.trim() || this.args.value;\n      this.context.selectValue(this.args.value, label);\n    }\n  };\n\n  registerElement = modifier((element: HTMLDivElement) => {\n    this.itemElement = element;\n  });\n\n  <template>\n    {{! template-lint-disable require-mandatory-role-attributes require-presentational-children }}\n    <div\n      class={{cn\n        \"focus:bg-accent focus:text-accent-foreground hover:bg-accent hover:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-disabled:pointer-events-none data-disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2\"\n        @class\n      }}\n      data-disabled={{if @disabled \"true\"}}\n      data-slot=\"select-item\"\n      role=\"option\"\n      {{on \"click\" this.handleClick}}\n      {{this.registerElement}}\n      ...attributes\n    >\n      <span\n        class=\"absolute right-2 flex size-3.5 items-center justify-center\"\n        data-slot=\"select-item-indicator\"\n      >\n        {{#if this.isSelected}}\n          <Check class=\"size-4\" />\n        {{/if}}\n      </span>\n      {{yield}}\n    </div>\n  </template>\n}\n\ninterface SelectSeparatorSignature {\n  Element: HTMLDivElement;\n  Args: {\n    class?: string;\n  };\n}\n\nconst SelectSeparator: TOC<SelectSeparatorSignature> = <template>\n  <div\n    class={{cn \"bg-border pointer-events-none -mx-1 my-1 h-px\" @class}}\n    data-slot=\"select-separator\"\n    ...attributes\n  ></div>\n</template>;\n\ninterface SelectScrollUpButtonSignature {\n  Element: HTMLDivElement;\n  Args: {\n    class?: string;\n  };\n}\n\nconst SelectScrollUpButton: TOC<SelectScrollUpButtonSignature> = <template>\n  <div\n    class={{cn \"flex cursor-default items-center justify-center py-1\" @class}}\n    data-slot=\"select-scroll-up-button\"\n    ...attributes\n  >\n    <ChevronUp class=\"size-4\" />\n  </div>\n</template>;\n\ninterface SelectScrollDownButtonSignature {\n  Element: HTMLDivElement;\n  Args: {\n    class?: string;\n  };\n}\n\nconst SelectScrollDownButton: TOC<SelectScrollDownButtonSignature> = <template>\n  <div\n    class={{cn \"flex cursor-default items-center justify-center py-1\" @class}}\n    data-slot=\"select-scroll-down-button\"\n    ...attributes\n  >\n    <ChevronDown class=\"size-4\" />\n  </div>\n</template>;\n\nexport {\n  Select,\n  SelectTrigger,\n  SelectValue,\n  SelectContent,\n  SelectGroup,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n};\n",
      "type": "registry:ui"
    }
  ]
}
