{
  "$schema": "https://shadcn-ember.com/schema/registry-item.json",
  "name": "tooltip",
  "type": "registry:ui",
  "files": [
    {
      "path": "registry/new-york-v4/ui/tooltip.gts",
      "content": "import { on } from '@ember/modifier';\nimport { htmlSafe } from '@ember/template';\nimport {\n  computePosition,\n  flip,\n  shift,\n  offset,\n  arrow,\n  autoUpdate,\n  type Placement,\n} from '@floating-ui/dom';\nimport Component from '@glimmer/component';\nimport { tracked } from '@glimmer/tracking';\nimport { cached } from '@glimmer/tracking';\nimport { modifier } from 'ember-modifier';\nimport { provide, consume } from 'ember-provide-consume-context';\n\nimport { cn } from '@/lib/utils';\n\nimport type { TOC } from '@ember/component/template-only';\nimport type Owner from '@ember/owner';\n\nconst TooltipContext = 'tooltip-context' as const;\n\ninterface TooltipContextValue {\n  isOpen: boolean;\n  isRendered: boolean;\n  setOpen: (open: boolean) => void;\n  finishClose: () => void;\n  triggerElement: HTMLElement | null;\n  setTriggerElement: (element: HTMLElement | null) => void;\n}\n\ninterface ContextRegistry {\n  [TooltipContext]: TooltipContextValue;\n}\n\ninterface TooltipProviderSignature {\n  Args: {\n    delayDuration?: number;\n    skipDelayDuration?: number;\n  };\n  Blocks: {\n    default: [];\n  };\n}\n\nconst TooltipProvider: TOC<TooltipProviderSignature> = <template>\n  {{! template-lint-disable no-yield-only }}\n  {{yield}}\n</template>;\n\ninterface TooltipSignature {\n  Args: {\n    open?: boolean;\n    defaultOpen?: boolean;\n    onOpenChange?: (open: boolean) => void;\n  };\n  Blocks: {\n    default: [];\n  };\n}\n\nclass Tooltip extends Component<TooltipSignature> {\n  @tracked currentOpen: boolean;\n  @tracked isOpenOrClosing = false;\n  triggerElement: HTMLElement | null = null;\n\n  constructor(owner: Owner, args: TooltipSignature['Args']) {\n    super(owner, args);\n    this.currentOpen = args.open ?? args.defaultOpen ?? false;\n  }\n\n  get isOpen() {\n    return this.args.open ?? this.currentOpen;\n  }\n\n  get isRendered() {\n    return this.isOpen || this.isOpenOrClosing;\n  }\n\n  setOpen = (open: boolean) => {\n    if (open) {\n      this.isOpenOrClosing = true;\n      this.currentOpen = true;\n    } else {\n      this.currentOpen = false;\n    }\n    this.args.onOpenChange?.(open);\n  };\n\n  finishClose = () => {\n    if (!this.isOpen) {\n      this.isOpenOrClosing = false;\n    }\n  };\n\n  setTriggerElement = (element: HTMLElement | null) => {\n    this.triggerElement = element;\n  };\n\n  @cached\n  @provide(TooltipContext)\n  get context(): TooltipContextValue {\n    return {\n      isOpen: this.isOpen,\n      isRendered: this.isRendered,\n      setOpen: this.setOpen,\n      finishClose: this.finishClose,\n      triggerElement: this.triggerElement,\n      setTriggerElement: this.setTriggerElement,\n    };\n  }\n\n  <template>\n    <div data-slot=\"tooltip\">\n      {{yield}}\n    </div>\n  </template>\n}\n\ninterface TooltipTriggerSignature {\n  Element: HTMLElement;\n  Args: {\n    class?: string;\n    asChild?: boolean;\n  };\n  Blocks: {\n    default: [];\n  };\n}\n\nclass TooltipTrigger extends Component<TooltipTriggerSignature> {\n  @consume(TooltipContext) context!: ContextRegistry[typeof TooltipContext];\n\n  handleMouseEnter = () => {\n    this.context.setOpen(true);\n  };\n\n  handleMouseLeave = () => {\n    this.context.setOpen(false);\n  };\n\n  handleFocus = () => {\n    this.context.setOpen(true);\n  };\n\n  handleBlur = () => {\n    this.context.setOpen(false);\n  };\n\n  registerElement = modifier((element: HTMLElement) => {\n    this.context.setTriggerElement(element);\n    return () => {\n      this.context.setTriggerElement(null);\n    };\n  });\n\n  <template>\n    {{#if @asChild}}\n      <span\n        class={{cn \"inline-block\" @class}}\n        data-slot=\"tooltip-trigger\"\n        {{on \"blur\" this.handleBlur}}\n        {{on \"focus\" this.handleFocus}}\n        {{on \"mouseenter\" this.handleMouseEnter}}\n        {{on \"mouseleave\" this.handleMouseLeave}}\n        {{this.registerElement}}\n        ...attributes\n      >\n        {{yield}}\n      </span>\n    {{else}}\n      <span\n        class={{cn \"inline-block\" @class}}\n        data-slot=\"tooltip-trigger\"\n        {{on \"blur\" this.handleBlur}}\n        {{on \"focus\" this.handleFocus}}\n        {{on \"mouseenter\" this.handleMouseEnter}}\n        {{on \"mouseleave\" this.handleMouseLeave}}\n        {{this.registerElement}}\n        ...attributes\n      >\n        {{yield}}\n      </span>\n    {{/if}}\n  </template>\n}\n\ninterface TooltipContentSignature {\n  Element: HTMLDivElement;\n  Args: {\n    class?: string;\n    side?: 'top' | 'right' | 'bottom' | 'left';\n    align?: 'start' | 'center' | 'end';\n    sideOffset?: number;\n  };\n  Blocks: {\n    default: [];\n  };\n}\n\nclass TooltipContent extends Component<TooltipContentSignature> {\n  @consume(TooltipContext) context!: ContextRegistry[typeof TooltipContext];\n  @tracked x = 0;\n  @tracked y = 0;\n  @tracked arrowX = 0;\n  @tracked arrowY = 0;\n  cleanup?: () => void;\n  arrowElement: HTMLElement | null = null;\n\n  get destinationElement() {\n    return document.body;\n  }\n\n  positionContent = modifier((element: HTMLElement) => {\n    const triggerElement = this.context.triggerElement;\n    if (!triggerElement) return;\n\n    const align = this.args.align ?? 'center';\n    const side = this.args.side ?? 'top';\n    const placementMap: Record<string, Placement> = {\n      'top-start': 'top-start',\n      'top-center': 'top',\n      'top-end': 'top-end',\n      'right-start': 'right-start',\n      'right-center': 'right',\n      'right-end': 'right-end',\n      'bottom-start': 'bottom-start',\n      'bottom-center': 'bottom',\n      'bottom-end': 'bottom-end',\n      'left-start': 'left-start',\n      'left-center': 'left',\n      'left-end': 'left-end',\n    };\n\n    const placement = placementMap[`${side}-${align}`] || ('top' as Placement);\n\n    const update = () => {\n      void computePosition(triggerElement, element, {\n        placement,\n        strategy: 'fixed',\n        middleware: [\n          offset(this.args.sideOffset ?? 4),\n          flip(),\n          shift({ padding: 8 }),\n          arrow({ element: this.arrowElement! }),\n        ],\n      }).then(({ x, y, middlewareData }) => {\n        this.x = x;\n        this.y = y;\n\n        if (middlewareData.arrow && this.arrowElement) {\n          this.arrowX = middlewareData.arrow.x ?? 0;\n          this.arrowY = middlewareData.arrow.y ?? 0;\n        }\n      });\n    };\n\n    this.cleanup = autoUpdate(triggerElement, element, update);\n\n    return () => {\n      this.cleanup?.();\n    };\n  });\n\n  arrowModifier = modifier((element: HTMLElement) => {\n    this.arrowElement = element;\n    return () => {\n      this.arrowElement = null;\n    };\n  });\n\n  get positionStyle() {\n    return htmlSafe(\n      `position: fixed; left: ${this.x}px; top: ${this.y}px; z-index: 50;`\n    );\n  }\n\n  get arrowStyle() {\n    return htmlSafe(`left: ${this.arrowX}px; top: ${this.arrowY}px;`);\n  }\n\n  handleAnimationEnd = (event: AnimationEvent) => {\n    if (event.target === event.currentTarget && !this.context.isOpen) {\n      this.context.finishClose();\n    }\n  };\n\n  <template>\n    {{#if this.context.isRendered}}\n      {{#in-element this.destinationElement insertBefore=null}}\n        <div\n          class={{cn\n            \"z-50 overflow-hidden rounded-md bg-foreground px-3 py-1.5 text-xs text-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95\"\n            @class\n          }}\n          data-align={{if @align @align \"center\"}}\n          data-side={{if @side @side \"top\"}}\n          data-slot=\"tooltip-content\"\n          data-state={{if this.context.isOpen \"open\" \"closed\"}}\n          role=\"tooltip\"\n          style={{this.positionStyle}}\n          {{on \"animationend\" this.handleAnimationEnd}}\n          {{this.positionContent}}\n          ...attributes\n        >\n          {{yield}}\n          <div\n            class=\"absolute bg-foreground size-2 rotate-45\"\n            style={{this.arrowStyle}}\n            {{this.arrowModifier}}\n          ></div>\n        </div>\n      {{/in-element}}\n    {{/if}}\n  </template>\n}\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider };\n",
      "type": "registry:ui"
    }
  ]
}
