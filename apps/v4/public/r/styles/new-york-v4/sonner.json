{
  "$schema": "https://shadcn-ember.com/schema/registry-item.json",
  "name": "sonner",
  "type": "registry:ui",
  "dependencies": ["ember-cli-flash", "ember-modifier", "ember-truth-helpers"],
  "files": [
    {
      "path": "registry/new-york-v4/ui/sonner.gts",
      "content": "import { fn } from '@ember/helper';\nimport { on } from '@ember/modifier';\nimport { guidFor } from '@ember/object/internals';\nimport { service } from '@ember/service';\nimport { htmlSafe } from '@ember/template';\nimport Component from '@glimmer/component';\nimport { tracked } from '@glimmer/tracking';\nimport { modifier } from 'ember-modifier';\nimport { eq, lt } from 'ember-truth-helpers';\n\nimport type { ToastCustomFields } from '@/services/flash-messages';\nimport type ThemeService from '@/services/theme';\nimport type { FlashMessagesService, FlashObject } from 'ember-cli-flash';\n\nimport CircleCheck from '~icons/lucide/circle-check';\nimport Info from '~icons/lucide/info';\nimport Loader2 from '~icons/lucide/loader-2';\nimport OctagonX from '~icons/lucide/octagon-x';\nimport TriangleAlert from '~icons/lucide/triangle-alert';\n\nconst VISIBLE_TOASTS_AMOUNT = 3;\nconst TOAST_WIDTH = 356;\nconst GAP = 14;\n\ntype Position =\n  | 'top-left'\n  | 'top-center'\n  | 'top-right'\n  | 'bottom-left'\n  | 'bottom-center'\n  | 'bottom-right';\n\ntype Toast = FlashObject<ToastCustomFields> & ToastCustomFields;\n\ninterface ToasterSignature {\n  Element: HTMLElement;\n  Args: {\n    position?: Position;\n    class?: string;\n    richColors?: boolean;\n    expand?: boolean;\n  };\n}\n\nfunction toastStyle(\n  heightMap: Record<string, number>,\n  toasts: Toast[],\n  index: number\n): ReturnType<typeof htmlSafe> {\n  let heightBefore = 0;\n\n  for (let i = 0; i < index; i++) {\n    heightBefore += heightMap[guidFor(toasts[i])] ?? 0;\n  }\n\n  const currentId = guidFor(toasts[index]);\n\n  return htmlSafe(\n    `--index: ${index}; --toasts-before: ${index}; --z-index: ${toasts.length - index}; --offset: ${index * GAP + heightBefore}px; --initial-height: ${heightMap[currentId] ?? 0}px`\n  );\n}\n\n/**\n * Reads `flash.type` while consuming the tracked `toasts` array,\n * so Glimmer re-evaluates when the queue is reassigned (e.g. after\n * a promise toast transitions from loading â†’ success/error).\n */\nfunction toastType(toasts: Toast[], flash: Toast): string | undefined {\n  void toasts.length;\n  return flash.type;\n}\n\nclass Toaster extends Component<ToasterSignature> {\n  @service declare flashMessages: FlashMessagesService<ToastCustomFields>;\n  @service declare theme: ThemeService;\n\n  @tracked expanded = false;\n  @tracked heightMap: Record<string, number> = {};\n\n  get position(): Position {\n    return this.args.position ?? 'top-center';\n  }\n\n  get yPosition() {\n    return this.position.split('-')[0]!;\n  }\n\n  get xPosition() {\n    return this.position.split('-')[1]!;\n  }\n\n  get isExpanded() {\n    return this.expanded || this.args.expand;\n  }\n\n  get toasts(): Toast[] {\n    return [...this.flashMessages.arrangedQueue].reverse();\n  }\n\n  get frontToastHeight() {\n    for (const toast of this.toasts) {\n      const height = this.heightMap[guidFor(toast)];\n\n      if (height !== undefined) return height;\n    }\n\n    return 0;\n  }\n\n  get toasterStyle() {\n    return htmlSafe(\n      `--front-toast-height: ${this.frontToastHeight}px; --width: ${TOAST_WIDTH}px; --gap: ${GAP}px; --normal-bg: var(--popover); --normal-text: var(--popover-foreground); --normal-border: var(--border); --border-radius: var(--radius); --offset-top: 24px; --offset-right: 24px; --offset-bottom: 24px; --offset-left: 24px; --mobile-offset-top: 16px; --mobile-offset-right: 16px; --mobile-offset-bottom: 16px; --mobile-offset-left: 16px`\n    );\n  }\n\n  registerHeight = (id: string, height: number) => {\n    if (this.heightMap[id] === height) return;\n    this.heightMap = { ...this.heightMap, [id]: height };\n  };\n\n  unregisterHeight = (id: string) => {\n    const next = { ...this.heightMap };\n    delete next[id];\n    this.heightMap = next;\n  };\n\n  setupToast = modifier((element: HTMLElement, [flash]: [Toast]) => {\n    const id = guidFor(flash);\n    let mountRaf: number | undefined;\n\n    const raf = requestAnimationFrame(() => {\n      this.registerHeight(id, element.getBoundingClientRect().height);\n\n      mountRaf = requestAnimationFrame(() => {\n        element.dataset['mounted'] = 'true';\n      });\n    });\n\n    return () => {\n      cancelAnimationFrame(raf);\n      if (mountRaf !== undefined) cancelAnimationFrame(mountRaf);\n      this.unregisterHeight(id);\n    };\n  });\n\n  handleMouseEnter = () => {\n    this.expanded = true;\n\n    for (const flash of this.flashMessages.arrangedQueue) {\n      flash.preventExit();\n    }\n  };\n\n  handleMouseMove = () => {\n    this.expanded = true;\n  };\n\n  handleMouseLeave = () => {\n    this.expanded = false;\n\n    for (const flash of this.flashMessages.arrangedQueue) {\n      if (!flash.exiting) flash.allowExit();\n    }\n  };\n\n  handleAction = (flash: Toast) => {\n    flash.action?.onClick?.();\n    flash.destroyMessage();\n  };\n\n  <template>\n    <section\n      aria-atomic=\"false\"\n      aria-label=\"Notifications alt+T\"\n      aria-live=\"polite\"\n      aria-relevant=\"additions text\"\n      tabindex=\"-1\"\n    >\n      {{#if this.toasts.length}}\n        <ol\n          class=\"toaster group\"\n          data-sonner-theme={{this.theme.resolvedTheme}}\n          data-sonner-toaster=\"true\"\n          data-x-position={{this.xPosition}}\n          data-y-position={{this.yPosition}}\n          dir=\"ltr\"\n          style={{this.toasterStyle}}\n          tabindex=\"-1\"\n          {{on \"mouseenter\" this.handleMouseEnter}}\n          {{on \"mouseleave\" this.handleMouseLeave}}\n          {{on \"mousemove\" this.handleMouseMove}}\n          ...attributes\n        >\n          {{#each this.toasts as |flash index|}}\n            {{#let (toastType this.toasts flash) as |type|}}\n            <li\n              class=\"cn-toast\"\n              data-dismissible=\"true\"\n              data-expanded={{if this.isExpanded \"true\" \"false\"}}\n              data-front={{if (eq index 0) \"true\" \"false\"}}\n              data-index={{index}}\n              data-mounted=\"false\"\n              data-promise=\"false\"\n              data-removed={{if flash.exiting \"true\" \"false\"}}\n              data-rich-colors={{if @richColors \"true\" \"false\"}}\n              data-sonner-toast=\"\"\n              data-styled=\"true\"\n              data-swipe-out=\"false\"\n              data-swiped=\"false\"\n              data-swiping=\"false\"\n              data-type={{type}}\n              data-visible={{if\n                (lt index VISIBLE_TOASTS_AMOUNT)\n                \"true\"\n                \"false\"\n              }}\n              data-x-position={{this.xPosition}}\n              data-y-position={{this.yPosition}}\n              style={{toastStyle this.heightMap this.toasts index}}\n              tabindex=\"0\"\n              {{this.setupToast flash}}\n            >\n              {{#if (eq type \"success\")}}\n                <div data-icon=\"\">\n                  <CircleCheck class=\"size-4\" />\n                </div>\n              {{else if (eq type \"info\")}}\n                <div data-icon=\"\">\n                  <Info class=\"size-4\" />\n                </div>\n              {{else if (eq type \"warning\")}}\n                <div data-icon=\"\">\n                  <TriangleAlert class=\"size-4\" />\n                </div>\n              {{else if (eq type \"error\")}}\n                <div data-icon=\"\">\n                  <OctagonX class=\"size-4\" />\n                </div>\n              {{else if (eq type \"loading\")}}\n                <div data-icon=\"\">\n                  <Loader2 class=\"size-4 animate-spin\" />\n                </div>\n              {{/if}}\n              <div data-content=\"\">\n                {{#if flash.message}}\n                  <div data-title=\"\">\n                    {{flash.message}}\n                  </div>\n                {{/if}}\n                {{#if flash.description}}\n                  <div data-description=\"\">\n                    {{flash.description}}\n                  </div>\n                {{/if}}\n              </div>\n              {{#if flash.action}}\n                <button\n                  data-action=\"true\"\n                  data-button=\"true\"\n                  type=\"button\"\n                  {{on \"click\" (fn this.handleAction flash)}}\n                >\n                  {{flash.action.label}}\n                </button>\n              {{/if}}\n            </li>\n            {{/let}}\n          {{/each}}\n        </ol>\n      {{/if}}\n    </section>\n  </template>\n}\n\nexport { Toaster };\n",
      "type": "registry:ui"
    },
    {
      "path": "registry/new-york-v4/services/flash-messages.ts",
      "content": "import { FlashMessagesService } from 'ember-cli-flash';\n\nexport default class CustomFlashMessagesService extends FlashMessagesService {\n  get flashMessageDefaults() {\n    return {\n      ...super.flashMessageDefaults,\n      type: 'default',\n    };\n  }\n}\n",
      "type": "registry:ui"
    }
  ]
}
