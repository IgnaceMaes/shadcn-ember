{
  "$schema": "https://shadcn-ember.com/schema/registry-item.json",
  "name": "accordion",
  "type": "registry:ui",
  "dependencies": [
    "@ember/modifier",
    "@glimmer/component",
    "@glimmer/tracking",
    "ember-modifier",
    "ember-provide-consume-context"
  ],
  "files": [
    {
      "path": "registry/new-york-v4/ui/accordion.gts",
      "content": "import { on } from '@ember/modifier';\nimport Component from '@glimmer/component';\nimport { tracked } from '@glimmer/tracking';\nimport { modifier } from 'ember-modifier';\nimport { provide, consume } from 'ember-provide-consume-context';\n\nimport { cn } from '@/lib/utils';\n\nimport ChevronDown from '~icons/lucide/chevron-down';\n\nconst AccordionContext = 'accordion-context' as const;\nconst AccordionItemContext = 'accordion-item-context' as const;\n\ninterface AccordionContextValue {\n  value: string | string[];\n  type: 'single' | 'multiple';\n  collapsible: boolean;\n  disabled: boolean;\n  toggle: (itemValue: string) => void;\n}\n\ninterface AccordionItemContextValue {\n  value: string;\n  disabled: boolean;\n  isRendered: boolean;\n  finishClose: () => void;\n}\n\ninterface ContextRegistry {\n  [AccordionContext]: AccordionContextValue;\n  [AccordionItemContext]: AccordionItemContextValue;\n}\n\ninterface AccordionItemSignature {\n  Element: HTMLDivElement;\n  Args: {\n    value: string;\n    class?: string;\n    disabled?: boolean;\n  };\n  Blocks: {\n    default: [];\n  };\n}\n\ninterface AccordionTriggerSignature {\n  Element: HTMLButtonElement;\n  Args: {\n    class?: string;\n  };\n  Blocks: {\n    default: [];\n  };\n}\n\ninterface AccordionContentSignature {\n  Element: HTMLDivElement;\n  Args: {\n    class?: string;\n  };\n  Blocks: {\n    default: [];\n  };\n}\n\ninterface AccordionSignature {\n  Element: HTMLDivElement;\n  Args: {\n    type?: 'single' | 'multiple';\n    value?: string | string[];\n    defaultValue?: string | string[];\n    onValueChange?: (value: string | string[]) => void;\n    collapsible?: boolean;\n    disabled?: boolean;\n    class?: string;\n  };\n  Blocks: {\n    default: [];\n  };\n}\n\nclass AccordionTrigger extends Component<AccordionTriggerSignature> {\n  @consume(AccordionContext)\n  accordionContext!: ContextRegistry[typeof AccordionContext];\n  @consume(AccordionItemContext)\n  itemContext!: ContextRegistry[typeof AccordionItemContext];\n\n  get isOpen() {\n    if (Array.isArray(this.accordionContext.value)) {\n      return this.accordionContext.value.includes(this.itemContext.value);\n    }\n    return this.accordionContext.value === this.itemContext.value;\n  }\n\n  handleClick = () => {\n    if (!this.itemContext.disabled && !this.accordionContext.disabled) {\n      this.accordionContext.toggle(this.itemContext.value);\n    }\n  };\n\n  <template>\n    <h3 class=\"flex\">\n      <button\n        class={{cn\n          \"flex flex-1 items-center justify-between py-4 text-sm font-medium transition-all hover:underline text-left [&[data-state=open]>svg]:rotate-180\"\n          @class\n        }}\n        data-state={{if this.isOpen \"open\" \"closed\"}}\n        type=\"button\"\n        {{on \"click\" this.handleClick}}\n        ...attributes\n      >\n        {{yield}}\n        <ChevronDown\n          class=\"size-4 shrink-0 text-muted-foreground transition-transform duration-200\"\n        />\n      </button>\n    </h3>\n  </template>\n}\n\nclass AccordionContent extends Component<AccordionContentSignature> {\n  @consume(AccordionContext)\n  accordionContext!: ContextRegistry[typeof AccordionContext];\n  @consume(AccordionItemContext)\n  itemContext!: ContextRegistry[typeof AccordionItemContext];\n\n  get isOpen() {\n    if (Array.isArray(this.accordionContext.value)) {\n      return this.accordionContext.value.includes(this.itemContext.value);\n    }\n    return this.accordionContext.value === this.itemContext.value;\n  }\n\n  handleAnimationEnd = (event: AnimationEvent) => {\n    if (event.target === event.currentTarget && !this.isOpen) {\n      this.itemContext.finishClose();\n    }\n  };\n\n  heightAnimation = modifier((element: HTMLElement) => {\n    element.style.setProperty(\n      '--radix-accordion-content-height',\n      `${element.scrollHeight}px`\n    );\n  });\n\n  <template>\n    {{#if this.itemContext.isRendered}}\n      <div\n        class=\"data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down overflow-hidden text-sm\"\n        data-state={{if this.isOpen \"open\" \"closed\"}}\n        {{on \"animationend\" this.handleAnimationEnd}}\n        {{this.heightAnimation}}\n        ...attributes\n      >\n        <div class={{cn \"pb-4 pt-0\" @class}}>\n          {{yield}}\n        </div>\n      </div>\n    {{/if}}\n  </template>\n}\n\nclass AccordionItem extends Component<AccordionItemSignature> {\n  @consume(AccordionContext)\n  accordionContext!: ContextRegistry[typeof AccordionContext];\n\n  @tracked isOpenOrClosing = false;\n\n  get isOpen() {\n    return Array.isArray(this.accordionContext.value)\n      ? this.accordionContext.value.includes(this.args.value)\n      : this.accordionContext.value === this.args.value;\n  }\n\n  get isRendered() {\n    return this.isOpen || this.isOpenOrClosing;\n  }\n\n  finishClose = () => {\n    if (!this.isOpen) {\n      this.isOpenOrClosing = false;\n    }\n  };\n\n  trackOpenState = modifier(() => {\n    if (this.isOpen) {\n      this.isOpenOrClosing = true;\n    }\n  });\n\n  @provide(AccordionItemContext)\n  get itemContext(): AccordionItemContextValue {\n    return {\n      value: this.args.value,\n      disabled: this.args.disabled ?? false,\n      isRendered: this.isRendered,\n      finishClose: this.finishClose,\n    };\n  }\n\n  <template>\n    <div\n      class={{cn \"border-b last:border-b-0\" @class}}\n      data-disabled={{if @disabled \"true\"}}\n      data-state={{if this.isOpen \"open\" \"closed\"}}\n      {{this.trackOpenState}}\n      ...attributes\n    >\n      {{yield}}\n    </div>\n  </template>\n}\n\nclass Accordion extends Component<AccordionSignature> {\n  @tracked internalValue: string | string[] | undefined = undefined;\n\n  get value() {\n    if (this.args.value !== undefined) {\n      return this.args.value;\n    }\n    if (this.internalValue !== undefined) {\n      return this.internalValue;\n    }\n    return this.args.defaultValue ?? (this.type === 'multiple' ? [] : '');\n  }\n\n  get type() {\n    return this.args.type ?? 'single';\n  }\n\n  get collapsible() {\n    return this.args.collapsible ?? false;\n  }\n\n  get disabled() {\n    return this.args.disabled ?? false;\n  }\n\n  setValue = (newValue: string | string[]) => {\n    this.internalValue = newValue;\n    this.args.onValueChange?.(newValue);\n  };\n\n  toggle = (itemValue: string) => {\n    if (this.type === 'multiple' && Array.isArray(this.value)) {\n      const isCurrentlyOpen = this.value.includes(itemValue);\n      const newValue = isCurrentlyOpen\n        ? this.value.filter((v) => v !== itemValue)\n        : [...this.value, itemValue];\n      this.setValue(newValue);\n    } else {\n      const isCurrentlyOpen = this.value === itemValue;\n      const newValue = isCurrentlyOpen && this.collapsible ? '' : itemValue;\n      this.setValue(newValue);\n    }\n  };\n\n  @provide(AccordionContext)\n  get context(): AccordionContextValue {\n    return {\n      value: this.value,\n      type: this.type,\n      collapsible: this.collapsible,\n      disabled: this.disabled,\n      toggle: this.toggle,\n    };\n  }\n\n  <template>\n    <div class={{@class}} data-orientation=\"vertical\" ...attributes>\n      {{yield}}\n    </div>\n  </template>\n}\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent };\n",
      "type": "registry:ui"
    }
  ]
}
