{
  "$schema": "https://shadcn-ember.com/schema/registry-item.json",
  "name": "input-otp",
  "type": "registry:ui",
  "files": [
    {
      "path": "registry/new-york-v4/ui/input-otp.gts",
      "content": "import { on } from '@ember/modifier';\nimport Component from '@glimmer/component';\nimport { tracked } from '@glimmer/tracking';\nimport { cached } from '@glimmer/tracking';\nimport { modifier } from 'ember-modifier';\nimport { consume, provide } from 'ember-provide-consume-context';\n\nimport { cn } from '@/lib/utils';\n\nimport type { TOC } from '@ember/component/template-only';\n\nimport Minus from '~icons/lucide/minus';\n\nconst InputOTPContext = 'input-otp-context' as const;\n\ninterface SlotData {\n  char: string;\n  hasFakeCaret: boolean;\n  isActive: boolean;\n}\n\ninterface InputOTPContextValue {\n  slots: SlotData[];\n  activeIndex: number;\n  handleSlotClick: (index: number) => void;\n}\n\ninterface ContextRegistry {\n  [InputOTPContext]: InputOTPContextValue;\n}\n\ninterface InputOTPSignature {\n  Element: HTMLDivElement;\n  Args: {\n    maxLength?: number;\n    value?: string;\n    onValueChange?: (value: string) => void;\n    disabled?: boolean;\n    containerClassName?: string;\n    class?: string;\n  };\n  Blocks: {\n    default: [];\n  };\n}\n\ninterface InputOTPGroupSignature {\n  Element: HTMLDivElement;\n  Args: {\n    class?: string;\n  };\n  Blocks: {\n    default: [];\n  };\n}\n\ninterface InputOTPSlotSignature {\n  Element: HTMLDivElement;\n  Args: {\n    index: number;\n    class?: string;\n  };\n  Blocks: {\n    default: [];\n  };\n}\n\ninterface InputOTPSeparatorSignature {\n  Element: HTMLDivElement;\n  Args: {\n    class?: string;\n  };\n  Blocks: {\n    default: [];\n  };\n}\n\nclass InputOTP extends Component<InputOTPSignature> {\n  @tracked internalValue = '';\n  @tracked activeIndex = 0;\n  @tracked isFocused = false;\n\n  hiddenInputElement?: HTMLInputElement;\n\n  get value(): string {\n    return this.args.value ?? this.internalValue;\n  }\n\n  set value(newValue: string) {\n    if (this.args.value === undefined) {\n      this.internalValue = newValue;\n    }\n  }\n\n  get maxLength() {\n    return this.args.maxLength ?? 6;\n  }\n\n  get slots(): SlotData[] {\n    const slots: SlotData[] = [];\n    for (let i = 0; i < this.maxLength; i++) {\n      const char = this.value[i] || '';\n      const isActive = this.isFocused && i === this.activeIndex;\n      const hasFakeCaret = isActive && !char;\n      slots.push({ char, hasFakeCaret, isActive });\n    }\n    return slots;\n  }\n\n  @cached\n  @provide(InputOTPContext)\n  get contextValue(): InputOTPContextValue {\n    return {\n      slots: this.slots,\n      activeIndex: this.activeIndex,\n      handleSlotClick: this.handleSlotClick,\n    };\n  }\n\n  setupHiddenInput = modifier((element: HTMLInputElement) => {\n    this.hiddenInputElement = element;\n\n    return () => {\n      this.hiddenInputElement = undefined;\n    };\n  });\n\n  handleFocus = () => {\n    this.isFocused = true;\n  };\n\n  handleBlur = () => {\n    this.isFocused = false;\n  };\n\n  updateValue(newValue: string, newActiveIndex?: number) {\n    if (this.args.value === undefined) {\n      this.internalValue = newValue;\n    }\n    if (newActiveIndex !== undefined) {\n      this.activeIndex = newActiveIndex;\n    }\n    if (this.args.onValueChange) {\n      this.args.onValueChange(newValue);\n    }\n  }\n\n  handleInput = (event: Event) => {\n    const input = event.target as HTMLInputElement;\n    let inputValue = input.value;\n    inputValue = inputValue.replace(/[^a-zA-Z0-9]/g, '');\n\n    if (inputValue.length > 0) {\n      const newValue = (\n        this.value.slice(0, this.activeIndex) +\n        inputValue[0] +\n        this.value.slice(this.activeIndex + 1)\n      ).slice(0, this.maxLength);\n\n      const newActiveIndex = Math.min(this.activeIndex + 1, this.maxLength - 1);\n      input.value = '';\n\n      this.updateValue(newValue, newActiveIndex);\n    }\n  };\n\n  handleKeyDown = (event: KeyboardEvent) => {\n    if (event.key === 'Backspace') {\n      event.preventDefault();\n      if (this.value.length > 0) {\n        const charAtCurrent = this.value[this.activeIndex];\n        if (charAtCurrent) {\n          const newValue =\n            this.value.slice(0, this.activeIndex) +\n            this.value.slice(this.activeIndex + 1);\n          this.updateValue(newValue);\n        } else if (this.activeIndex > 0) {\n          const newValue =\n            this.value.slice(0, this.activeIndex - 1) +\n            this.value.slice(this.activeIndex);\n          const newActiveIndex = Math.max(0, this.activeIndex - 1);\n          this.updateValue(newValue, newActiveIndex);\n        }\n      }\n    } else if (event.key === 'Delete') {\n      event.preventDefault();\n      if (this.activeIndex < this.value.length) {\n        const newValue =\n          this.value.slice(0, this.activeIndex) +\n          this.value.slice(this.activeIndex + 1);\n        this.updateValue(newValue);\n      }\n    } else if (event.key === 'ArrowLeft') {\n      event.preventDefault();\n      this.activeIndex = Math.max(0, this.activeIndex - 1);\n    } else if (event.key === 'ArrowRight') {\n      event.preventDefault();\n      this.activeIndex = Math.min(\n        Math.min(this.value.length, this.maxLength - 1),\n        this.activeIndex + 1\n      );\n    } else if (event.key === 'Home') {\n      event.preventDefault();\n      this.activeIndex = 0;\n    } else if (event.key === 'End') {\n      event.preventDefault();\n      this.activeIndex = Math.min(this.value.length, this.maxLength - 1);\n    }\n  };\n\n  handlePaste = (event: ClipboardEvent) => {\n    event.preventDefault();\n    const pastedText = event.clipboardData?.getData('text') || '';\n    const newValue = pastedText\n      .replace(/[^a-zA-Z0-9]/g, '')\n      .slice(0, this.maxLength);\n    const newActiveIndex = Math.min(newValue.length, this.maxLength - 1);\n    this.updateValue(newValue, newActiveIndex);\n  };\n\n  handleSlotClick = (index: number) => {\n    if (!this.args.disabled) {\n      this.activeIndex = Math.min(index, this.value.length);\n      this.hiddenInputElement?.focus();\n    }\n  };\n\n  <template>\n    <div\n      class={{cn\n        \"flex items-center gap-2 has-disabled:opacity-50\"\n        @containerClassName\n        @class\n      }}\n      data-slot=\"input-otp\"\n      ...attributes\n    >\n      <input\n        aria-label=\"OTP input\"\n        autocomplete=\"one-time-code\"\n        class=\"absolute left-0 top-0 size-0 opacity-0\"\n        disabled={{@disabled}}\n        inputmode=\"text\"\n        type=\"text\"\n        {{on \"blur\" this.handleBlur}}\n        {{on \"focus\" this.handleFocus}}\n        {{on \"input\" this.handleInput}}\n        {{on \"keydown\" this.handleKeyDown}}\n        {{on \"paste\" this.handlePaste}}\n        {{this.setupHiddenInput}}\n      />\n      {{yield}}\n    </div>\n  </template>\n}\n\nconst InputOTPGroup: TOC<InputOTPGroupSignature> = <template>\n  <div\n    class={{cn \"flex items-center\" @class}}\n    data-slot=\"input-otp-group\"\n    ...attributes\n  >\n    {{yield}}\n  </div>\n</template>;\n\nclass InputOTPSlot extends Component<InputOTPSlotSignature> {\n  @consume(InputOTPContext)\n  context!: ContextRegistry[typeof InputOTPContext];\n\n  get slotData() {\n    return (\n      this.context.slots[this.args.index] ?? {\n        char: '',\n        hasFakeCaret: false,\n        isActive: false,\n      }\n    );\n  }\n\n  handleClick = () => {\n    this.context.handleSlotClick(this.args.index);\n  };\n\n  <template>\n    <button\n      class={{cn\n        \"data-[active=true]:border-ring data-[active=true]:ring-ring/50 data-[active=true]:aria-invalid:ring-destructive/20 dark:data-[active=true]:aria-invalid:ring-destructive/40 aria-invalid:border-destructive data-[active=true]:aria-invalid:border-destructive dark:bg-input/30 border-input relative flex h-9 w-9 items-center justify-center border-y border-r text-sm shadow-xs transition-all outline-none first:rounded-l-md first:border-l last:rounded-r-md data-[active=true]:z-10 data-[active=true]:ring-[3px]\"\n        @class\n      }}\n      data-active={{if this.slotData.isActive \"true\" \"false\"}}\n      data-slot=\"input-otp-slot\"\n      type=\"button\"\n      {{on \"click\" this.handleClick}}\n      ...attributes\n    >\n      {{this.slotData.char}}\n      {{#if this.slotData.hasFakeCaret}}\n        <div\n          class=\"pointer-events-none absolute inset-0 flex items-center justify-center\"\n        >\n          <div class=\"bg-foreground h-4 w-px animate-caret-blink\"></div>\n        </div>\n      {{/if}}\n    </button>\n  </template>\n}\n\nconst InputOTPSeparator: TOC<InputOTPSeparatorSignature> = <template>\n  {{! template-lint-disable require-presentational-children }}\n  <div data-slot=\"input-otp-separator\" role=\"separator\" ...attributes>\n    <Minus aria-hidden=\"true\" />\n  </div>\n</template>;\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator };\n",
      "type": "registry:ui"
    }
  ]
}
